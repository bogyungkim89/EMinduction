import streamlit as st
import random

st.set_page_config(page_title="ì „ìê¸° ìœ ë„ í•™ìŠµ", page_icon="âš¡", layout="centered")

st.title("âš¡ ì „ìê¸° ìœ ë„ í˜„ìƒ í•™ìŠµ ì›¹ì•±")
st.write("---")
st.markdown("#### ğŸ¯ ë§‰ëŒ€ìì„ê³¼ ì½”ì¼ì˜ ìƒí˜¸ì‘ìš©ì„ í†µí•´ ìê¸°ë ¥, ìê·¹, ì „ë¥˜ ë°©í–¥ì„ í•™ìŠµí•´ë³´ì„¸ìš”!")

# ==============================
# 1ï¸âƒ£ ëœë¤ ìƒí™© ì„¤ì •
# ==============================
cases = {
    1: "Nê·¹ì´ ì½”ì¼ì— ê°€ê¹Œì›Œì§„ë‹¤",
    2: "Sê·¹ì´ ì½”ì¼ì— ê°€ê¹Œì›Œì§„ë‹¤",
    3: "Nê·¹ì´ ì½”ì¼ì—ì„œ ë©€ì–´ì§„ë‹¤",
    4: "Sê·¹ì´ ì½”ì¼ì—ì„œ ë©€ì–´ì§„ë‹¤"
}

answers = {
    1: {"force": "ìœ„ìª½", "coil_pole": "ìœ—ë©´ Nê·¹, ì•„ë«ë©´ Sê·¹", "current": "ì‹œê³„ë°©í–¥"},
    2: {"force": "ìœ„ìª½", "coil_pole": "ìœ—ë©´ Sê·¹, ì•„ë«ë©´ Nê·¹", "current": "ë°˜ì‹œê³„ë°©í–¥"},
    3: {"force": "ì•„ë˜ìª½", "coil_pole": "ìœ—ë©´ Sê·¹, ì•„ë«ë©´ Nê·¹", "current": "ë°˜ì‹œê³„ë°©í–¥"},
    4: {"force": "ì•„ë˜ìª½", "coil_pole": "ìœ—ë©´ Nê·¹, ì•„ë«ë©´ Sê·¹", "current": "ì‹œê³„ë°©í–¥"},
}

if "selected_case" not in st.session_state:
    st.session_state.selected_case = random.choice(list(cases.keys()))

case_num = st.session_state.selected_case
st.subheader(f"ğŸ“˜ ìƒí™©: **{cases[case_num]}**")

# ì‹œê°ì  ì„¤ëª…
st.image("https://i.imgur.com/kWQZVtC.png", caption="ì½”ì¼ê³¼ ë§‰ëŒ€ìì„ì˜ ê¸°ë³¸ êµ¬ì¡° (ì˜ˆì‹œ)", use_column_width=True)
st.write("ì½”ì¼ì€ ì›í†µì˜ ì˜¤ë¥¸ìª½ ìœ„ì—ì„œ ê°ê²¨ ì‹œê³„ë°©í–¥ìœ¼ë¡œ ê°ê¸´ í˜•íƒœì…ë‹ˆë‹¤.")

st.write("---")

# ==============================
# 2ï¸âƒ£ í€´ì¦ˆ 1: ìê¸°ë ¥ ë°©í–¥
# ==============================
st.markdown("### ğŸ§­ 1ë‹¨ê³„: ì½”ì¼ì´ ë§‰ëŒ€ìì„ì— ê°€í•˜ëŠ” ìê¸°ë ¥ì˜ ë°©í–¥ì€?")
force_answer = st.radio(
    "ë§‰ëŒ€ìì„ì˜ ì›€ì§ì„ì„ ë°©í•´í•˜ëŠ” ë°©í–¥ì„ ì„ íƒí•˜ì„¸ìš”:",
    ["ìœ„ìª½ (ë°€ì–´ëƒ„)", "ì•„ë˜ìª½ (ëŒì–´ë‹¹ê¹€)"]
)

# ==============================
# 3ï¸âƒ£ í€´ì¦ˆ 2: ì½”ì¼ì˜ ìê·¹
# ==============================
st.markdown("### ğŸ§² 2ë‹¨ê³„: ì½”ì¼ì˜ ìê·¹ì€ ì–´ë””ì¼ê¹Œ?")
pole_answer = st.radio(
    "ì½”ì¼ì˜ ìœ—ë©´ê³¼ ì•„ë«ë©´ì˜ ìê·¹ì„ ì„ íƒí•˜ì„¸ìš”:",
    ["ìœ—ë©´ Nê·¹, ì•„ë«ë©´ Sê·¹", "ìœ—ë©´ Sê·¹, ì•„ë«ë©´ Nê·¹"]
)

# ==============================
# 4ï¸âƒ£ í€´ì¦ˆ 3: ì „ë¥˜ ë°©í–¥
# ==============================
st.markdown("### ğŸ”„ 3ë‹¨ê³„: ì½”ì¼ì— íë¥´ëŠ” ì „ë¥˜ì˜ ë°©í–¥ì€?")
current_answer = st.radio(
    "ì½”ì¼ ìœ—ë©´ì—ì„œ ë°”ë¼ë´¤ì„ ë•Œ ì „ë¥˜ì˜ ë°©í–¥ì„ ì„ íƒí•˜ì„¸ìš”:",
    ["ì‹œê³„ë°©í–¥", "ë°˜ì‹œê³„ë°©í–¥"]
)

st.write("---")

# ==============================
# 5ï¸âƒ£ ê²°ê³¼ í™•ì¸
# ==============================
if st.button("âœ… ì •ë‹µ í™•ì¸"):
    correct = answers[case_num]

    result_stage = 0  # 0: ì „ì²´ ì •ë‹µ, 1~3: ì–´ëŠ ë‹¨ê³„ì—ì„œ ì˜¤ë‹µì¸ì§€ í‘œì‹œ

    if ("ìœ„ìª½" in force_answer and correct["force"] != "ìœ„ìª½") or \
       ("ì•„ë˜ìª½" in force_answer and correct["force"] != "ì•„ë˜ìª½"):
        result_stage = 1
    elif pole_answer != correct["coil_pole"]:
        result_stage = 2
    elif current_answer != correct["current"]:
        result_stage = 3

    if result_stage == 0:
        st.success("ğŸ‰ ì •ë‹µì´ì—ìš”! ì „ìê¸° ìœ ë„ í˜„ìƒì„ ì™„ë²½í•˜ê²Œ ì´í•´í–ˆì–´ìš”.")
    elif result_stage == 1:
        st.error(f"âŒ 1ë‹¨ê³„ ì˜¤ë‹µì´ì—ìš”. ì˜¬ë°”ë¥¸ ìê¸°ë ¥ ë°©í–¥ì€ **{correct['force']}** ì…ë‹ˆë‹¤.")
    elif result_stage == 2:
        st.error(f"âŒ 2ë‹¨ê³„ ì˜¤ë‹µì´ì—ìš”. ì½”ì¼ì˜ ìê·¹ì€ **{correct['coil_pole']}** ì…ë‹ˆë‹¤.")
    elif result_stage == 3:
        st.error(f"âŒ 3ë‹¨ê³„ ì˜¤ë‹µì´ì—ìš”. ì „ë¥˜ì˜ ë°©í–¥ì€ **{correct['current']}** ì…ë‹ˆë‹¤.")

    with st.expander("ğŸ’¡ ì •ë‹µ ë° í•´ì„¤ ë³´ê¸°"):
        st.markdown(f"""
        - **ìê¸°ë ¥ ë°©í–¥:** {correct['force']}
        - **ì½”ì¼ì˜ ìê·¹:** {correct['coil_pole']}
        - **ì „ë¥˜ ë°©í–¥:** {correct['current']}
        """)

        st.info("""
        ë Œì¸ ì˜ ë²•ì¹™ì— ë”°ë¥´ë©´, ìœ ë„ ì „ë¥˜ëŠ” **ìì„ì˜ ì›€ì§ì„ì„ ë°©í•´í•˜ëŠ” ë°©í–¥**ìœ¼ë¡œ íë¦…ë‹ˆë‹¤.
        ì¦‰, ê°€ê¹Œì›Œì§€ë©´ ë°€ì–´ë‚´ê³ , ë©€ì–´ì§€ë©´ ëŒì–´ë‹¹ê¸°ëŠ” ë°©í–¥ì´ì—ìš”.
        """)

# ==============================
# 6ï¸âƒ£ ìƒˆ ë¬¸ì œ
# ==============================
if st.button("ğŸ”„ ìƒˆ ìƒí™© ë°›ê¸°"):
    st.session_state.selected_case = random.choice(list(cases.keys()))
    st.experimental_rerun()

st.write("---")
st.caption("Â© 2025 ì „ìê¸° ìœ ë„ í•™ìŠµ ì•± â€” Streamlit ê¸°ë°˜")
